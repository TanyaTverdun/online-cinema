<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - onlineCinema</title>

    <!-- СТИЛІ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/lux/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/onlineCinema.styles.css" asp-append-version="true" />

    <style>
        /* Стилі для хедера та кнопок, щоб вони відповідали темі Lux */
        .header-bg { background-color: var(--bs-black) !important; border-bottom: 1px solid var(--bs-gray-800) !important; }
        .logo-box { background-color: var(--bs-danger); color: var(--bs-white); width: 40px; height: 40px; border-radius: 2px; }
        .nav-custom-link { color: var(--bs-gray-600) !important; font-weight: 500; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; transition: 0.3s; }
        .nav-custom-link:hover { color: var(--bs-white) !important; }
        .user-badge { background-color: var(--bs-gray-900); border: 1px solid var(--bs-gray-800); transition: 0.3s; }
        .user-badge:hover { border-color: var(--bs-gray-600); }
        .user-avatar { background-color: var(--bs-gray-700); color: var(--bs-white); width: 32px; height: 32px; }
        .btn-login { color: var(--bs-white); border: 1px solid var(--bs-gray-600); border-radius: 2px; font-size: 0.85rem; letter-spacing: 1px; }
        .btn-login:hover { background-color: var(--bs-white); color: var(--bs-black); }
        .btn-signup { background-color: var(--bs-danger); border: 1px solid var(--bs-danger); color: var(--bs-white); border-radius: 2px; font-size: 0.85rem; letter-spacing: 1px; }
    </style>
</head>
<body class="bg-black text-white">

    <header>
        <nav class="navbar navbar-expand-lg header-bg py-3">
            <div class="container-fluid px-4">

                <a class="navbar-brand d-flex align-items-center gap-2" asp-controller="Home" asp-action="Index">
                    <div class="logo-icon d-flex align-items-center justify-content-center logo-box">
                        <i class="bi bi-film fs-4"></i>
                    </div>
                    <div class="fw-bold fs-4 lh-1 text-uppercase" style="letter-spacing: 1px;">
                        <span style="color: var(--bs-white);">Online</span><span style="color: var(--bs-danger);">Cinema</span>
                    </div>
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                    <span class="navbar-toggler-icon" style="filter: invert(1);"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarContent">

                    @if (User.Identity != null && User.Identity.IsAuthenticated)
                    {
                        <!-- МЕНЮ ДЛЯ ЗАРЕЄСТРОВАНОГО -->
                        <ul class="navbar-nav mx-auto mb-2 mb-lg-0 gap-lg-4">
                            <li class="nav-item"><a class="nav-link nav-custom-link" asp-controller="Movies" asp-action="Index">Movies</a></li>
                            <li class="nav-item"><a class="nav-link nav-custom-link" asp-controller="Schedule" asp-action="Index">Schedule</a></li>
                            <li class="nav-item"><a class="nav-link nav-custom-link" asp-controller="Profile" asp-action="MyProfile">My Profile</a></li>
                        </ul>
                        <div class="d-flex align-items-center gap-3 mt-3 mt-lg-0">
                            <div class="user-badge d-flex align-items-center gap-3 px-3 py-1 rounded-pill">
                                <span class="fw-bold small text-uppercase text-white">@User.Identity?.Name</span>
                                <div class="user-avatar rounded-circle d-flex align-items-center justify-content-center"><i class="bi bi-person-fill"></i></div>
                            </div>
                            <form class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                                <button type="submit" class="btn btn-link p-0" title="Logout" style="color: var(--bs-gray-600);"><i class="bi bi-box-arrow-right fs-5"></i></button>
                            </form>
                        </div>
                    }
                    else
                    {
                        <!-- МЕНЮ ДЛЯ ГОСТЯ -->
                        <ul class="navbar-nav me-auto"></ul>
                        <div class="d-flex gap-3 mt-3 mt-lg-0">
                            <a class="btn btn-login px-4 py-2 fw-bold text-uppercase" asp-area="Identity" asp-page="/Account/Login">Log In</a>
                            <a class="btn btn-signup px-4 py-2 fw-bold text-uppercase" asp-area="Identity" asp-page="/Account/Register">Sign Up</a>
                        </div>
                    }
                </div>
            </div>
        </nav>
    </header>

    <!-- "Розумний" контейнер для контенту -->
    @if ((bool?)ViewData["UseFullWidthLayout"] == true)
    {
        <!-- Для сторінки бронювання (на весь екран) -->
        <main role="main">
            @RenderBody()
        </main>
    }
    else
    {
        <!-- Для всіх інших сторінок (з відступами) -->
        <div class="container py-4">
            <main role="main">
                @RenderBody()
            </main>
        </div>
    }

    <!-- Футер буде відображатись на всіх сторінках, крім бронювання -->
    <footer class="footer mt-auto py-3 bg-black border-top border-opacity-25">
        <div class="container text-center">
            <span class="text-white-50 small">
                &copy; @DateTime.Now.Year onlineCinema • Всі права захищено
            </span>
        </div>
    </footer>

    <!-- СКРИПТИ -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>